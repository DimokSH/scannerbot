# Краткое описание проекта — scannerbot

**Обновлено:** 2025-02-15 (VAN после загрузки репозитория)

---

## Обзор

- **Название проекта:** scannerbot  
- **Рабочий каталог:** `c:\scannerbot`  
- **Репозиторий:** https://github.com/DimokSH/scannerbot  
- **Стек:** Python, Flask, фронтенд (HTML/CSS/JS), библиотека html5-qrcode для сканирования.

---

## Структура проекта

| Путь | Назначение |
|------|------------|
| `app.py` | Flask-приложение: ключи, QR/данные сканера, загрузка фото, генерация ключей, маршрут `/ii/` для запросов к ИИ. |
| `ii.py` | Интеграция с Gemini API: по названию товара возвращает описание/характеристики (JSON), через прокси. |
| `templates/index.html` | Главная страница: пароль (ключ), кнопка «Сканировать QR-код», сканер на базе **html5-qrcode**, загрузка фото, выход. |
| `templates/foto.html` | Страница для фото. |
| `static/html5-qrcode.min.js` | Библиотека сканирования — сейчас используется только для **QR-кодов**. |
| `static/styles.css` | Стили. |
| `uploads/` | Каталог загружаемых фото (по ключу). |

---

## Как устроено сканирование

- **Где:** в браузере, на странице из `templates/index.html`.
- **Библиотека:** `Html5Qrcode` из `html5-qrcode.min.js` (сканер с камеры).
- **Конфиг:** `fps: 15`, `qrbox: 250` — ориентирован на QR.
- **При успехе:** вызывается `onScanSuccess(decodedText, decodedResult)` → отправка на сервер `GET /newqr/?key=...&qr=...`, воспроизведение звука, остановка сканера.
- **Бэкенд:** маршрут `/newqr/` в `app.py` принимает любой текст в параметре `qr` и сохраняет в `storage[key]` — поддержка штрихкода на бэкенде уже есть.

**Вывод:** для поддержки обычного штрихкода нужно изменить фронтенд: либо включить распознавание штрихкодов в текущей библиотеке (если она это умеет), либо добавить/заменить библиотеку, которая умеет и QR, и barcode.

---

## Ключевые компоненты

- Работа по ключу (пароль 3 цифры): `checkKey`, `newqr`, `getStorage`, `upload_photo`, `getfoto`, `generateNewKey`, `deleteKey` и т.д.
- Хранение: `storage` (коды по ключу), `uploads` (фото по ключу), `myKeys` / `myKeysParams` (ключи и даты).
- В `app.py` зашит адрес сервера: локально `http://127.0.0.1:5000`, иначе `https://scannerbot.ru` (строка 306).

---

## Первая задача (из tasks.md)

Добавить сканирование **обычного штрихкода** (barcode) в дополнение к QR при работе с видеокамерой.
